(function(n,t,i,r){"use strict";function f(n){this.$element=n;this._name=e;this.init(n)}function s(n){for(var f,t,r=[],u=n.settings.selectors.additionalFields,i=0;i<u.length;i++)if(f=u[i],t=n.find(f),t.length>0){var e=t.attr("name"),o=t.attr("value"),s={name:e,value:o};r.push(s)}return r}if(typeof jQuery=="undefined")throw new Error("serverValidate requires jQuery");if(typeof jQuery.validator=="undefined")throw new Error("serverValidate requires jQuery validation plugin & jquery.validate.unobtrusive plugin.");var e="serverValidate",u=null,o={crossDomain:!0,multipleRequests:!0,checkValidationBeforeSendingRequest:!0,dontSendSameRequestTwice:!0,disableInputOnValidation:!0,focusPersistIfNotValid:!0,hideOnValidation:!1,messages:{requesting:"Requesting data..."},selectors:{divContainer:".form-row",validatorContainer:".validator-container",validator:".validator",additionalFields:["[name=__RequestVerificationToken]"]},attributes:{url:"data-url",isValidate:"data-is-validate",submitMethod:"data-submit-method"},icons:{invalid:"validation-icon-invalid fa fa-times",valid:"validation-icon-valid fa fa-check",spinner:"validation-icon-spinner fa fa-refresh fa-spin-custom",error:"validation-icon-error fa fa-exclamation-circle"},iconsIdPrefixes:{invalid:"invalid-mark-",valid:"valid-mark-",spinner:"validation-spinner-",error:"validation-error-"},response:{message:"Field is valid.",isValid:!0,isError:!1,errorCode:null,errorMessage:null},events:{beforeSendingRequest:function(){},responseReceived:function(){},responseProcessed:function(){}}};n.extend(f.prototype,{isDebugging:!1,isEmpty:function(n){return n===null||n===r||n.length===0},init:function(n){this.isValidForProcessing(n)&&this.processDiv(n)},getSettings:function(){return u.settings},isMultipleRequestAllowed:function(){return u.settings.multipleRequests},isDisableInputOnValidation:function(){return u.settings.disableInputOnValidation},isInputValidationRequirestoSendRequest:function(){return u.settings.checkValidationBeforeSendingRequest},dontSendSameRequestTwice:function(){return u.settings.dontSendSameRequestTwice},getAttributes:function(){var n=u;return n.settings.attributes},getEvents:function(){var n=u;return n.settings.events},getIcons:function(){var n=u;return n.settings.icons},getIdPrefixes:function(){var n=u;return n.settings.iconsIdPrefixes},getSelectors:function(){var n=u;return n.settings.selectors},getMessages:function(){var n=u;return n.settings.messages},isValidForProcessing:function(n){var t=this.getAttributes();return n.attr(t.isValidate)==="true"},getInput:function(){if(this.isEmpty(this.$input)){var n=this.$element;this.$input=n.find("input")}return this.$input},getUrl:function(){var n=this.getAttributes(),t=this.getInput();return t.attr(n.url)},processDiv:function(n){var t=this.getInput(n),i=this.getUrl();this.inputProcessWithBlurEvent(n,t,i)},test:function(){this.showSpinner($input)},setCurrentTextForNexttimeChecking:function(n){n.attr("data-previous-submit",n.val())},isPreviousRequestIsSame:function(n){var i=n.attr("data-previous-submit"),t=i===n.val();return this.isDebugging&&console.log("Request is same : "+t),t},bindFormWithInvalidEvent:function(){},inputProcessWithBlurEvent:function(n,t,i){var r=this,u=this.getSettings();t.on("blur",function(u){r.blurEvent(u,n,r,t,i)})},blurEvent:function(n,t,i,r,u){var e=!i.isInProcessingMode(t)||i.isMultipleRequestAllowed(),f,o,s,h;e&&(f=r,o=i.dontSendSameRequestTwice(),e=o&&!i.isPreviousRequestIsSame(f)||!o,e&&(s=i.isInputValidationRequirestoSendRequest(),e=s&&f.valid()||!s,e&&(h=i.concatAdditionalFields(f),i.sendRequest(t,f,u,h)),i.getSettings().focusPersistIfNotValid&&i.focusIfnotValid(f)))},focusIfnotValid:function(n,t){if(t===!0){n.focus();return}n.valid()===!1&&n.focus()},concatAdditionalFields:function(n){var t=u.additionalFields.slice(),i={name:n.attr("name"),value:n.val()};return t.push(i),t},getSubmitMethod:function(n){var t=u.settings.attributes;return n.attr(t.submitMethod)},abortPreviousAjaxRequest:function(n){this.showSpinner(n);this.hideInvalidIcon(n);this.hideErrorIcon(n);this.hideErrorIcon(n);this.hideValidIcon(n);this.isEmpty(this.ajaxRequest)||this.ajaxRequest.abort()},sendRequest:function(n,t,i,r){var f=this.getSubmitMethod(t),u=this,e=u.isDebugging;n.attr("data-icon-added","true");this.abortPreviousAjaxRequest(t);u.markAsProcessing(n,!0);u.setCurrentTextForNexttimeChecking(t);this.ajaxRequest=jQuery.ajax({method:f,url:i,data:r,crossDomain:!0,dataType:"JSON"}).done(function(i){e&&console.log(i);u.markAsProcessing(n,!1);u.processResponse(t,i);u.hideSpinner(t)}).fail(function(n,r,f){u.hideSpinner(t);u.errorProcess(t,n,r,f,i);console.log("Request failed: "+f+". Url : "+i)})},errorProcess:function(n,t,i){var r=t.status,f=this.getSettings(),u="";r===0&&(r=404,i="Requested url doesn't lead to a valid request.");u="Code "+r+" : "+i;this.showErrorIcon(n,u);f.focusPersistIfNotValid&&this.focusIfnotValid(n,!0)},markAsProcessing:function(n,t){this.isDebugging&&console.log("Making: "+t);n.attr("data-is-processing",t)},isInProcessingMode:function(n){var t=n.attr("data-is-processing");return this.isDebugging&&console.log("is Processing: "+t),t==="true"},getInputNameOrId:function(n){var t=n.attr("id");return this.isEmpty(t)&&(t=n.attr("name")),t},setMessageOnIcons:function(n,t){var i=n.find("a").attr("title",t).attr("data-original-title",t).find("span");i.attr("title",t).attr("data-display",t)},createIcons:function(t,i,r,u){var s=this.getInputNameOrId(t),h=this.getValidator(),e=this.getWrapperPrefix(),f=u+s,c="<div class='validation-icon-wrapper' id='"+e+f+"'><a data-toggle='tooltip' id='"+f+"'title='"+r+"' data-original-title='"+r+"' class='tooltip-show'><span data-display='"+r+"' class='"+i+"' title='"+r+"'><\/span><\/a><\/div>",o;return h.append(c),o=n.byId(e+f),n.byId(f).tooltip(),o},getWrapperPrefix:function(){return"wrapper-"},getValidator:function(){if(this.isEmpty(this.$validator)){var n=this.getSelectors();this.$validator=this.$element.find(n.validator)}return this.$validator},getCachedIcon:function(n,t){var r=this.getIdPrefixes(),s=this.getWrapperPrefix()+t+this.getInputNameOrId(n),e="$"+s,u=this[e];if(this.isEmpty(u)){var h=this.getMessages(),o="",f=this.getIcons(),i="";t===r.spinner?(i=f.spinner,o=h.requesting):t===r.valid?i=f.valid:t===r.invalid?i=f.invalid:t===r.error&&(i=f.error);u=this.createIcons(n,i,o,t);this[e]=u}return u},getInvalidIcon:function(n){if(this.isEmpty(this.$invalidMarkIcon)){var t=this.getIdPrefixes();this.$invalidMarkIcon=this.getCachedIcon(n,t.invalid)}return this.$invalidMarkIcon},getValidIcon:function(n){if(this.isEmpty(this.$validMarkIcon)){var t=this.getIdPrefixes();this.$validMarkIcon=this.getCachedIcon(n,t.valid)}return this.$validMarkIcon},getSpinner:function(n){if(this.isEmpty(this.$spinner)){var t=this.getIdPrefixes();this.$spinner=this.getCachedIcon(n,t.spinner)}return this.$spinner},getErrorIcon:function(n){if(this.isEmpty(this.$errorIcon)){var t=this.getIdPrefixes();this.$errorIcon=this.getCachedIcon(n,t.error)}return this.$errorIcon},showErrorIcon:function(n,t){var i=this.getErrorIcon(n);this.setMessageOnIcons(i,t);this.animateOn(i)},showSpinner:function(n){var t=this.getSpinner(n);this.animateOn(t)},showInvalidIcon:function(n,t){var i=this.getInvalidIcon(n);this.setMessageOnIcons(i,t);this.animateOn(i)},showValidIcon:function(n,t){var i=this.getValidIcon(n);this.setMessageOnIcons(i,t);this.animateOn(i)},hideValidIcon:function(n){var t=this.getValidIcon(n);this.animateOff(t)},hideErrorIcon:function(n){var t=this.getErrorIcon(n);this.animateOff(t)},hideInvalidIcon:function(n){var t=this.getInvalidIcon(n);this.animateOff(t)},hideSpinner:function(n){var t=this.getSpinner(n);this.animateOff(t)},animateOn:function(n){n.fadeIn("slow")},animateOff:function(n){n.hide()},processResponse:function(t,i){var f=u,r=this,e=f.settings.response;i=n.extend({},e,i);i.isValid?r.validResponse(t,i):r.inValidResponse(t,i)},validResponse:function(n,t){var u;this.showValidIcon(n,t.message);u=this.isDisableInputOnValidation();u&&n.attr("disabled","disabled");var i=this.$element,e=this.getSettings(),r=!0,f=t.message;i.attr("data-server-validated",r).attr("data-message",f);n.attr("data-server-validated",r).attr("data-message",f);e.hideOnValidation&&(i.attr("data-is-hidden",r),i.hide("slow"))},inValidResponse:function(n,t){this.showInvalidIcon(n,t.errorCode+" : "+t.errorMessage);var u=this.$element,i=!1,f=this.getSettings(),r=t.errorMessage;u.attr("data-server-validated",i).attr("data-message",r);n.attr("data-server-validated",i).attr("data-message",r);f.focusPersistIfNotValid&&this.focusIfnotValid(n,!0)}});n.fn.serverValidate=function(t){var r=this,e,i,h;for(u=this,r.isInit!==!0&&(this.settings=n.extend({},o,t),e=this.settings.selectors,this.$divContainers=r.find(e.divContainer),this.additionalFields=s(r),this.isInit=!0),i=0;i<this.$divContainers.length;i++)h=n(this.$divContainers[i]),new f(h,t)}})(jQuery,window,document);
//# sourceMappingURL=jquery.server-validate.min.js.map
